# 2. SAP 조회 Automation 생성

## 데이터 분류별 조회

1. 상단의 **작업** 탭으로 이동하여, **작업 추가**를 진행합니다.</br>
   작업 추가 팝업 창에서 **+ 새 작업** - **새 Power Automate 작업** 을 선택합니다.</br>
   Power Automate 창으로 자동으로 이동합니다.

   <img src="https://github.com/user-attachments/assets/1b048d51-3dec-4f87-9736-f71323d5c48e" width=600/>

2. 흐름의 제목을 변경합니다.

   ```
   SAP 카테고리 기반 제품검색
   ```

   ![그림13](https://github.com/user-attachments/assets/003cbe8a-fef6-462a-b0b4-05094143a01c)

3. **Copilot에서 흐름 실행**을 클릭하면 좌측 패널이 열립니다. 순서대로 **+ 입력 추가** - **텍스트**를 선택하여 입력을 추가한 후, 이름을 변경합니다.

   <img src="https://github.com/user-attachments/assets/c9cf29e4-ab96-404e-8496-011358c7b924" width=800/>

4. 동일한 방법으로 **Respond to the agent**에 출력을 추가합니다.

   <img src="https://github.com/user-attachments/assets/557248cd-bb20-4ff8-adb6-b363788e9753" width=800/>

5. 둘 사이에 +를 눌러 커넥터를 추가합니다. **SAP OData** 아래의 **OData 엔터티 쿼리**를 선택합니다.

   <img src="https://github.com/user-attachments/assets/d0f5eda9-1869-420d-95b8-6d4f1df29487" width=800/>

6. 연결을 새로 생성해 줍니다. 각 입력해야 할 내용은 아래를 참고하세요. </br>
   연결 이름
   ```
   SAP-ES5
   ```
   OData 기본 URI
   ```
   https://sapes5.sapdevcenter.com/sap/opu/odata/iwbep/GWSAMPLE_BASIC
   ```

   사용자 이름과 암호에는 SAP Gateway System의 ID와 Password를 입력하고, 연결을 생성합니다.

   <img src="https://github.com/user-attachments/assets/952e2253-3c94-478b-8b50-4bc2b6d35185" width=600/>

7. **OData 엔터티 이름**에서 **ProductSet**을 선택하고, 아래 **고급 매개 변수** 옆의 **모두 표시**를 클릭합니다.

   <img src="https://github.com/user-attachments/assets/5f99698d-bed3-4818-8134-0791899627a4" width=600/>

8. **filter**를 찾아 수식을 입력합니다.

   ```
   concat('Category eq ', '''', triggerBody()['text'], '''')
   ```

   <img src="https://github.com/user-attachments/assets/3c6e34a6-ad9f-4351-898c-ccea809a07ac" width=600/>

9. 출력 변수에 **본문**을 추가해 줍니다.

   <img src="https://github.com/user-attachments/assets/a88f6f78-5cbe-4b86-9f0b-6869adfb5379" width=600/>

10. 초안 저장 및 테스트를 수행합니다. </br>
   테스트는 **수동**으로 진행하며, 입력 값은 **Keyboards**입니다.

   ```
   Keyboards
   ```
   
   <img src="https://github.com/user-attachments/assets/84478723-3390-4fa9-86bf-5a9480854b4e" width=600/>

11. 테스트가 완료되면 결과를 확인해볼 수 있습니다.

   <img src="https://github.com/user-attachments/assets/aefac320-d4ca-4af5-902c-2e5f47149932" width=800/>


